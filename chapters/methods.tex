\chapter{Methods}\label{cha:methods}

I first sample paleo- and modern surface attitude data across the summit of \acl{OM} using satellite-derived imagery and topography, respectively. Next, I develop a geometric framework for calculating minimum 3D surface deformation at each sampled location, based on collected attitude data. Next, I determine how much of this deformation must have been toward or away from the center of the edifice for each sampled location. Using these results, I develop a series of axisymmetric numerical models to relate surface deformation to underlying reservoir activity.

\section{Challenges \& Assumptions}
The topographic and structural deformation implies a combination of underlying volcanic processes including a.\ caldera collapse (i.e., magmatic discharge) and b.\ subsequent reservoir inflation (i.e., magmatic recharge). Untangling the superposition of these competing factors is challenging in itself, although preliminary inspection of the study region (Figure~\ref{fig:summit}) indicates that these effects may be localized to a.\ the immediate circumferential region, and b.\ the southern flank, respectively. Additionally, \textit{independent}\footnote{That is, in addition to observed deformation.} stratigraphic constraints on lava flow emplacement relative to the timeline of deformation are unavailable---while crater-dating can be done on lava flows and caldera floors, the timing of reservoir inflation does not leave a temporal record observable from spacecraft. Therefore, certain simplifying assumptions are necessary to make progress with this inquiry. In particular, with only ``initial'' (at flow emplacement) and ``final'' (modern) data points available for each location, only net change can be inferred.

\section{Preparation of Published Data}

\subsection{Raster Data}
The \acf{CTX}\footnote{aboard the \ac{MRO} spacecraft launched in 2005 by \acs{NASA}.} captures \qty{\sim30}{\km} swaths across the entire martian surface in visible $(\lambda=\qtyrange{500}{800}{\nm})$ greyscale at \qty{\sim6}{\m} spatial resolution. \textcite{Dickson2018AGB} blended these swaths to produce a raster mosaic product (hereafter, ``\ac{CTX} mosaic'') which I use to visually identify and map lava flows and flow channels.

The \acf{MOLA}\footnote{aboard the now-retired \ac{MGS} spacecraft launched in 1996 by \acs{NASA}.} returned topography data with horizontal resolution of \qtyproduct{300 x 1000}{\m} at the equator (better at high latitudes) and elevation uncertainty of \qty{\sim3}{\m}~\parencite{smith_mars_2001}. To improve spatial resolution, additional elevation data from the \ac{HRSC}\footnote{aboard the \ac{MEX} spacecraft launched in 2003 by the \ac{ESA}} was blended to product a \ac{DEM} with \qty{200}{\m} pixel resolution. Each pixel's vertical uncertainty is \qty{\sim1}{\m}, with an additional global uncertainty of \qty{\sim1.8}{\m} in the martian areoid (martian equivalent of Earth's geoid). In this project, the global areoid uncertainty is not a concern because only one region (the summit of \ac{OM}) is considered.

These two data sources were registered in an equal-area sinusoidal Mars projection in ArcGIS Pro. The study area is defined by a square \qtyproduct{200 x 200}{\km} centered at the centroid of the outermost \qty{19}{\km} contour,\footnote{This is the highest integer \unit{km} which is roughly circular and completely encloses the caldera complex, implying that it largely records the conical shape of the shield edifice without influence from subsequent caldera collapse or reservoir inflation.} as seen in Figure~\ref{fig:summit}.

\subsection{Prior Mapping}
I also include the caldera region mapping by \textcite{mouginis-mark_geologic_2021}, who identified lobate lava flows Relevant to the current project, 

\section{Study Area Definition \& Preliminary Analysis}

Figure~\ref{fig:summit} shows important topographic patterns at the summit of \ac{OM}. More than \qty{50}{\km} from the center of the figure, topographic contours (\qtyrange{12}{19}{\km}) are fairly regular concentric rings. Closer to the caldera, this radial symmetry breaks down: the caldera complex itself consists of six intersecting collapse pits. On the southern flank, we see a prominent arcuate \qty{20}{\km} contour with the topographic summit (within the \qty{21}{\km} contour) over \qty{20}{\km} from the southern caldera rim. I propose [BASED ON WHAT] that the distal symmetric regions preserve the long-term stable topography of the edifice, while the asymmetric central caldera complex and summit result from relatively recent magmatic activity. 

\subsection{Proto-Edifice Reconstruction}
Therefore, I present a reconstruction of the proto-edifice which interpolates the topography of the distal (beyond outer \qty{19}{\km} contour) regions within the central region. This reconstruction is shown in Figure~(NUMBER). This provides an independent estimation of proto-topography to compare with the estimates based on lava flow misalignment.

\section{Mapping Discordant Features}\label{sec:mapping}

\subsection{Lobate Flows}
I use the \ac{CTX} mosaic to visually identify lava flows near the summit of \ac{OM}. Following \textcite{mouginis-mark_geologic_2021}, I map lobate flow outlines as polygons where possible. From these polygons, I derive centerline features using the \hlss{Polygon To Centerline} tool, as shown in Figure~\ref{fig:flow}.

\subsection{Channels}

Where flow margins are not visible, I map channels directly as linear features. I include discontinuous regions where I infer partial collapse of lava tubes yielding skylight chains,\footnote{The assumption of underlying continuity follows, e.g., \textcite{bleacher_olympus_2007,carr_geologic_2010,peters_lava_2021}.} as shown in Figure~\ref{fig:channel}.

\section{Sampling Discordant Features}

\subsection{Linear Features}

\subsubsection{Segmentation}
[INCOMPLETE] Bounding box, aspect ratio

\subsubsection{Azimuths}

I use the \hlss{Calculate Geometry Attributes} tool to find the \hlss{Line Bearing} attribute for each linear feature (channel or flow centerline), that is, the azimuthal orientation from the start to the end of each feature. This angle is the variable \ac{az1} to each feature, although the following section discussion explains why this variable is not quite ready for use in attitude analysis. While I maintain a consistent ``sense'' in my channel mapping (pointing away from rather than toward the caldera center), the \hlss{Polygon To Centerline} tool does not. Therefore, some flow centerlines need to be reversed using the \hlss{Flip Line} tool.

To determine which centerlines must be reversed, I use the \hlss{Near} tool with \hlss{Angle} selected to determine the azimuth angle from each linear feature to the center of the study area \acs{center}. Here, I invoke the general empirical rule that all flows in the study area point generally \emph{away} from the caldera center. Therefore, a correctly oriented feature is one where \acs{az1} is \ang{\sim180} away from the calculated \hlss{Near Angle}; at the very least, it should be \ang{90} away. Therefore I select features where this angular difference\footnote{Specifically, I reverse features where the cosine of this angular difference is positive. See Appendix~[worth including spherical cosines?] for a justification of this approach which addresses an arithmetic issue with angular differences.} is less than \ang{90} to reverse using \hlss{Flip Line}. With all features now correctly oriented away from the caldera center, I recalculate \hlss{Line Bearing}, which establishes the correct \ac{az1} value for attitude analysis. [NEEDS FIGURE HERE]

\subsection{Point Features}

\newcommand{\samplinginterval}{\qty{3}{\km}}

Along each linear feature, I use the \hlss{Generate Points Along Line} tool to create a series of point features where further attitude data collection and analysis will take place. I use \hlss{Distance} mode with sampling interval \samplinginterval\ (rather than \hlss{Percentage} mode) so sampling reflects \emph{coverage}, not feature count. For the same reason, I do not \hlss{Include End Points}; features with length $<\samplinginterval$ are not sampled at all.

\begin{figure}
    \centering
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{flow.pdf}
        \caption[Mapped lava flow \& centerline]{A flow with lobate boundaries at each margin is mapped as a polygon (white) from which a linear centerline is derived for sampling.}%
        \label{fig:flow}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{channel.pdf}
        \caption[Mapped lava channel]{A lava channel is mapped as a linear feature, including regions of discontinuity which are inferred to be collapsed skylight chains over lava tubes.}%
        \label{fig:channel}
    \end{subfigure}
    \caption{Mapping linear features}%
    \label{fig:mapping-linear}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{sampling.pdf}
    \caption[Sampling site selection]{Each linear feature is assigned an average paleo-dip direction. Points are selected for sampling and calculations at \qty{5}{\km} and \qty{3}{\km} intervals for flows and channels, respectively. Paleo-dip direction is assigned to each point from its corresponding line; modern dip and dip direction is assigned to each point from its unique \ac{DEM} neighborhood.}%
    \label{fig:sampling}
\end{figure}

\section{Attitude Data Collection}

\newcommand{\neighborhood}{\qty{2}{\km}}

The first variable collected is \ac{az1}, which each point inherits from its parent linear feature.

Then, I use the \hlss{Surface Parameters} tool on the \ac{MOLA} \ac{DEM} to compute average topographic \hlss{Slope} and \hlss{Aspect} (downhill azimuth) rasters across the entire study area. To avoid capturing local topographic anomalies, these values are averaged\footnote{Technically, a quadratic surface is interpolated over the neighborhood region and dip and dip direction are computed at the center of this surface.} over a ``neighborhood'' with radius \neighborhood. I use the \hlss{Extract Multi Values to Points} tool to assign \ac{sl2} and \ac{az2} to each based on the value of the corresponding raster value at that location. Figure~\ref{fig:surface} shows the compact geometric representation of these attitude parameters as a pole to the topographic surface plane. Figure~[NEW FIGURE] shows a geometric view of all three collected variables, including the incomplete (\acs{az1} but not \acs{sl1}) representation of the paleo-surface attitude.

\begin{figure}
    \floatbox[{\capbeside\thisfloatsetup{floatwidth=sidefil,capbesideposition={left,bottom},capbesidewidth=.55\linewidth}}]{figure}
    {\caption[Pole to plane $\acs{normal2}=(\acs{az2},\acs{sl2})$]{The attitude of a tilted surface (green) is defined relative to horizontal (grey) by \ac{az2} and \ac{sl2}. \acs{az2} and \acs{sl2} are also the spherical coordinates of a unique unit vector \acs{normal2} which is normal (perpendicular) to the surface. In the subsequent sections, $\acs{normal2}=(\acs{az2},\acs{sl2})$ represents the observed attitude at a sampled location, while $\acs{normal1}=(\acs{az1},\acs{sl1})$ represents the \emph{inferred} paleo-attitude of the same point when the lava flow was emplaced. Azimuth angles increase clockwise from \acf{north} as shown, following geographic convention.}\label{fig:surface}}
    {\input{figures/surface.tex}}
\end{figure}

\section{Attitude Data Calculation}\label{sec:calculation}

\begin{figure}
\begin{center}
    \input{figures/tilt-from-map.tex}%
    \caption[Tilt from Map]{Tilt from map}%
    \label{fig:tilt-from-map}
\end{center}
\end{figure}

As seen in Figure~[NEW FIGURE PROBABLY JUST STEREONET], attitude data pertaining to the inferred paleo-surface is incomplete. Namely, while the modern topographic surface attitude is fully characterized by \acs{az2} and \acs{sl2}, only the \acf{az1} can be inferred directly from mapped surface features.

\section{Modelling Reservoir Pressure Change}

I use the numerical modelling software COMSOL Multiphysics 6.1 (COMSOL) to construct a numerical representation of \acf{OM}. The model is axisymmetric, about the center point discussed previously as the center of the \qty{19}{\km} contour. A profile from due south of this point is used as the 

\subsection{Parameter Sweep}

I run a series of numerical models using a \hlss{Parameter Sweep} over \ac{DtT}, \ac{Rr}, \ac{Rz}, and \ac{mult}:
\begin{equation}
    \acs{dP}=\acs{mult}\times\acs{rhor}\times\acs{g}\times\acs{DtT}.
\end{equation}

\subsection{Axisymmetric Tilt from Modelled Displacement}

The numerical formula for \acf{radial-deform} given \acs{disp_a} and \acs{disp_b} is derived from Figure~\ref{fig:tilt-from-model}:
\begin{equation}
    \boxed{\acs{radial-deform} = 
    \arctan\left(\dfrac{-\acs{dz1}-\acs{ddisp_z}}{\acs{dr1}+\acs{ddisp_r}}\right) - \arctan\left(\frac{-\acs{dz1}}{\acs{dr1}}\right).}\label{eq:tilt-from-model}
\end{equation}
For a flat model ($\acs{dz1} = 0$), Equation~\eqref{eq:tilt-from-model} reduces to
\begin{equation}
    \boxed{\acs{radial-deform} = 
    \arctan\left(\dfrac{-\acs{ddisp_z}}{\acs{dr1}+\acs{ddisp_r}}\right).}\label{eq:tilt-from-flat-model}
\end{equation}

\begin{figure}
    \input{figures/tilt-from-model.tex}
    \caption[Calculation of \acf{radial-deform} from modelling]{Axisymmetric tilt from finite element displacement. A model element at the surface of the model is shown as the ``Original Surface'' with slope \acs{proj1}. During the model, the two vertices of the surface element $A_1$ and $B_1$ are displaced via $\acs{disp_a}$ and $\acs{disp_b}$ to $A_2$ and $B_2$ respectively, bringing the element edge to the ``Deformed surface'' with slope \acs{proj2}. The horizontal (radial) and vertical components of the difference $\acs{disp_b} - \acs{disp_a} = \acs{ddisp}$ are labeled. The difference $\acs{proj2}-\acs{proj1}=\acs{radial-deform}$ is the exact same quantity illustrated in Figure~[NEEDS NEW FIGURE FOR NEW METHOD]. While Equation~[NEEDS NEW EQUATIONS] arrives at this value using lava flows discordant to their observed topographic surroundings, Equation~\eqref{eq:tilt-from-model} determines the value via numerically modelled surface displacement due to underlying reservoir inflation presumed to be responsible.}%
    \label{fig:tilt-from-model}
\end{figure}

\subsection{Comparison with Analytical Model}
The discrete Equation~\eqref{eq:tilt-from-flat-model} can be taken to the continuous limit by dividing each term in the numerator and denominator by the element width \acs{dr1}:
\begin{equation}
\acs{radial-deform}
    = \lim_{\acs{dr1}\to0} 
    \arctan\left(\dfrac{-\acs{ddisp_z}/\acs{dr1}}{\acs{dr1}/\acs{dr1}
    + \acs{ddisp_r}/\acs{dr1}}\right) = 
    \arctan\left(\dfrac{-\acs{disp_z'}}{1+\acs{disp_r'}}\right),\label{eq:tilt-from-flat-analytical-model}
\end{equation}
where $'$ denotes the derivative with respect to $r_1$. I use the \textcite{mogi_relations_1958} Model:
\begin{gather}
    \acs{disp_z} = ad{(d^2+r^2)}^{-1.5},\label{eq:uz_mogi}\\
    \acs{disp_r} = ar{(d^2+r^2)}^{-1.5},\label{eq:ur_mogi}\\
    a = {3R^3\Delta P}/{4G},\nonumber
\end{gather}
where $R$ is the reservoir radius, $\Delta P$ is the overpressure, and $G$ is the elastic shear modulus. Differentiating Equations~\eqref{eq:uz_mogi} and~\eqref{eq:ur_mogi}, substituting into Equation~\eqref{eq:tilt-from-flat-analytical-model}, and simplifying:
\begin{equation}
    \boxed{\acs{radial-deform} = \arctan\left(\frac{3adr}{{(d^2+r^2)}^{2.5}+ad^2-2ar^2}\right).}\label{eq:tilt-from-mogi-model}
\end{equation}

